API: https://client.vpn.nuist.edu.cn/https/webvpn893ff9021738b0357186c0f23fc2aed6e24ca283e886022bc5d861ea12f03963/v1/problem/logic?prefix=P&logicId=1673&enlink-vpn

在新冠(guān)肺炎疫情中，我们要找到一种方法来快速追踪与病例有过密切接触的人。

我们将现实的复杂情况简化成有向图与路径。在有向图上，每个点表示现实中的一个地点，每条有向边表示一种交通工具，可以从一点移动到另一点。因为原地移动是没有意义的，所以图上没有自环。

每个人的移动路线组成图上路径，每个人可能在某个地点停留一段时间，也可能正在通过交通工具移动，移动要消耗对应的时间。

当某个人被确诊时，我们需要找出所有与该患者有过密切接触的人。如果存在某一时刻，A 与 B 在同一地点或同一个交通工具上，那么判定 A 与 B 为密切接触。切换地点或交通工具的时刻也算在内，若 A 从时刻 0 开始停留在某地点 3 个单位时间，而 B 在时刻 3 到达该地点，则也判定 A 与 B 密切接触。

> 请注意：本题的“密切接触”定义与现实不同。

#### 输入描述

第 1 行：两个正整数 $n$ 和 $m$，表示有向图的点数和边数。

后续 $m$ 行：第 $i+1$ 行有三个整数 $u_i$, $v_i$, $t_i$，表示第 $i$ 种交通工具能够从 $u_i$ 移动到 $v_i$，耗时为 $t_i$。

第 $m + 2$ 行：两个正整数 $k$，$r$，表示追踪到了 $k$ 人，有 $r$ 条追踪记录。

第 $m+3$ 行：$k$ 个正整数，第 $x$ 个数字 $a_x$ 表示第 $x$ 人在时刻 $0$ 位于地点 $a_x$。

后续 $r$ 行：每行以一个整数开头，表示记录种类。

如果是记录种类为 1，后继两个整数 $x$，$y$，表示第 $x$ 人在原地停留了 $y$ 个单位时间。

如果是记录种类为 2，后继两个整数 $x$, $y$，表示第 $x$ 人通过第 $y$ 种交通工具进行了移动。

追踪记录对每个人保证时间顺序，对每个人的记录一定构成一条有效路径。

最后一行：一个正整数 $w$，表示第 $w$ 人被确诊为患者。

数据保证：

+ $1\le n\le100$
+ $1\le m\le400$
+ $1\le k\le1000$
+ $1\le r\le1000$
+ $1\le x \le k$
+ 记录 1 中 $y\ge1$
+ 记录 2 中 $1\ge y \le m$
+ $1\le w \le k$
+ 输入和运算过程中的时间数字之和不超过 10<sup>8</sup>

#### 输出描述

从小到大输出哪些人被判定为 $w$ 的密切接触者。

#### 样例输入

```
4 6
1 2 1
1 3 2
1 4 3
2 3 4
2 4 5
3 4 6
4 7
1 2 3 4
2 1 2
2 2 4
1 3 1
1 4 9
2 1 6
1 2 1
2 2 6
1
```

#### 样例输出

```
2 4
```

#### 样例解释

1. 第 1 人从地点 1 出发，经过 2 个单位时间到达地点 3。
2. 第 2 人从地点 2 出发，经过 4 个单位时间到达地点 3。
3. 第 3 人在地点 3 停留 1 个单位时间。
4. 第 4 人在地点 4 停留 9 个单位时间。
5. 第 1 人从地点 3 出发，经过 6 个单位时间到达地点 4。
6. 第 2 人在地点 3 停留 1 个单位时间。
7. 第 2 人从地点 3 出发，经过 6 个单位时间到达地点 4。

时刻 5 到时刻 8，第 1 人和第 2 人都在交通工具 6 上。

时刻 8，第 1 人和第 4 人都位于地点 4。

因此第 2 人和第 4 人是密切接触者。

<p style="font-size:15px;text-align:right">
<i>-- by Nugine</i>
</p>