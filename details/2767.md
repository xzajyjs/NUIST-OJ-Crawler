API: https://client.vpn.nuist.edu.cn/https/webvpn893ff9021738b0357186c0f23fc2aed6e24ca283e886022bc5d861ea12f03963/v1/problem/logic?prefix=b&logicId=2767&enlink-vpn

#### 题目描述

 南非世界杯离我们越来越近了，与足球有紧密联系的足球彩票也越来越引起了人们的强烈关注。

 了解足球彩票的人可能知道，足球彩票中有一种游戏叫做“胜负彩”，意为猜比赛的胜负。下面是一些与胜负彩有关的术语：

 **注** ：每一组有效组合数据。

 **投 注**：彩民以现金购买足球彩票的行为。

**单式投注**：彩民对于所有球队的比赛成绩均只选择一种预测结果的投注方式。投注的数量（注数）为1。

**复式投注**：彩民对于某些场次的比赛成绩选择两种以上的预测结果的投注方式。投注的数量为复式投注的组合数。例如，某彩民对一场比赛预测了两个结果（例如，胜平），另一场比赛预测了三个结果（胜负平），其他比赛都只预测了一种结果，那么注数就是2×3 = 6。这样的一个复式投注，可以看成一个包含六种单式投注的集合。

 胜负彩的玩法一般是这样的。彩票机构指定一轮比赛中的若干场，让彩民去猜每场比赛的结果（胜、负、平）。根据彩民猜中比赛的场次，来确定中奖的额度。

我们现在考虑一个简化的模型。对于一轮比赛，彩民需要竞猜其中_n_场比赛的结果，每场比赛的胜负平都有一个概率_p_(_i_, _r_)。其中，_i_表示第_i_场比赛。_r_ = 0, 1, 2，分别表示比赛结果的（主队）负、平、胜。_p_(_i_, _r_)则表示第_i_场比赛、结果为_r_的概率。此外，还有一个概率_q_(_i_, _r_)，表示第_i_场比赛，投注购买结果为_r_的概率。

例如，如果_q_(1,0) = 0.5，我们可以知道第一场比赛有50%的投注会买主队输球。我们假设这_n_场比赛互不相关，即_p_(_i_, _r_)的结果不会受_p_(_j_, _r_’)的影响，_q_(_i_, _r_)的结果也不会受_q_(_j_, _r_’)的影响（_r_ ≠ _r_’）。

 在这个模型里，我们规定，必须猜中全部_n_场比赛的结果才能获奖。总奖金为_M_，由所有获奖的投注平分。**因此，对于一个单式投注_Ri_ = {_ri_1, _ri_2,** **…****, _rin_}****，_rij_**表示投注_Ri_对第_j_场比赛的预测结果，它的中奖概率为：

![](../file/2767_0.jpg)

设投注总数为_N_，那么中奖的投注总数为：

![](../file/2767_1.jpg)

于是，投注_Ri_所能得到的奖金的期望（平均意义下能够获得的奖金数）就是：

![](../file/2767_2.jpg)

 以上考虑的仅仅是单式投注的情况，即仅考虑单注_Ri_的中奖情况。对于复式投注，情况要复杂一些。采用复式投注时，投注的是一个集合_R_ = {_R_1, _R_2, …, _Rk_}，其中_k_是投注的数量。例如，三场比赛，第一场猜“胜负”，第二场猜“平”，第三场猜“负平”，则_k_ = 4，_R_集合如下：

![](../file/2767_3.jpg)

复式投注_R_中，只要有一个_Ri_猜对所有比赛结果，即可中奖。因此，复式投注_R_所能获得的奖金的期望就是：![](../file/2767_4.jpg)

我们的问题是，给定_n_场比赛的信息（胜负平的概率和彩民购买三种结果的概率），以及复式投注中可以购买的最大注数_U_，要求设计一种复式投注的方案，在不超过最大注数（复式投注的注数_k_ ≤ _U_）的前提下，使得获得奖金的期望最大。

---

#### 输入格式

第一行四个整数_n, N, M, U_（_n_, _U_ ≤ 104, _N_, _M_ ≤ 109）。

 以下_n_行，每行六个实数。第_i_ + 1行的六个实数为_p_(_i_, 0), _p_(_i_, 1), _p_(_i_, 2), _q_(_i_, 0), _q_(_i_, 1)和_q_(_i_, 2)，用来描述第_i_场比赛的相关信息。其中，_p_(_i_, 0) + _p_(_i_, 1) + _p_(_i_, 2) = 1, _q_(_i_, 0) + _q_(_i_, 1) + _q_(_i_, 2) = 1, _q_(_i_, _j_) ≠ 0。

---

#### 输出格式

![](../file/2767_0.jpg)

---

#### 样例输入
```
1 10 10 1
0.3 0.2 0.5 0.7 0.2 0.1

```

---

#### 样例输出
```
1.609
```

---

#### 提示

没有写明提示

---

#### 题目来源

没有写明来源