API: https://client.vpn.nuist.edu.cn/https/webvpn893ff9021738b0357186c0f23fc2aed6e24ca283e886022bc5d861ea12f03963/v1/problem/logic?prefix=P&logicId=1722&enlink-vpn

#### 题目描述

有$n$个函数$f_1,f_2,f_3,...,f_n$.

对于$1\leqslant i\leqslant n$,规定$f_i(x)=a_ix+b_i$.

现有$q$次操作，每次操作有两种形式：

$1$ $t$ $a$ $b$: 将$f_t$修改为:$f_t(x)=ax+b$.

$2$ $l$ $r$ $x$: 询问$f_l(f_{l+1}(f_{l+2}(...f_r(x))))$

#### 输入描述

第一行两个整数$n$,$q$,表示函数个数和操作次数。

第二行$2n$个整数，分别为$a_1,b_1,a_2,b_2,...,a_n,b_n$。

接下来$q$行，每行$4$个整数 $1$ $t$ $a$ $b$ 或$2$ $l$ $r$ $x$，各自意义均如上所述。

#### 输出描述

对于每个类型为$2$的操作，输出答案对$998244353$取模的结果。

#### 样例输入
```
3 4
1 1 5 4 2 3
2 2 3 1
2 1 3 2
1 2 2 0
2 1 3 3
```
#### 样例输出
```
29
40
19
```

#### 样例解释

最开始，$f_1(x)=x+1,f_2(x)=5x+4,f_3(x)=2x+3$.

第一次操作查询$f_2(f_3(1))=5\times(2\times1+3)+4=29$.

第二次操作查询$f_1(f_2(f_3(2)))=1\times(5\times(2\times2+3)+4)+1=40$.

第三次操作将$f_2$变更为：$f_2(x)=2x$.

第四次操作查询$f_1(f_2(f_3(3)))=1\times(2\times(2\times3+3))+1=19$.

#### 数据规模与约定

$1\leq n,q \leq10^5$

$0\leq a_i,b_i \leq10^6$

对所有的操作，$1\leq t,l,r \leq n$,  $l \leq r$ , $0\leq a,b,x \leq10^6$。

#### 提示
本题数据量较大，建议使用 `scanf` 和 `printf` 输入输出。
